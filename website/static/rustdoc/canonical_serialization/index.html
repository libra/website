<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `canonical_serialization` crate."><meta name="keywords" content="rust, rustlang, rust-lang, canonical_serialization"><title>canonical_serialization - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../canonical_serialization/index.html'><img src='../rust-logo.png' alt='logo' width='100'></a><p class='location'>Crate canonical_serialization</p><div class="sidebar-elems"><a id='all-types' href='all.html'><p>See all canonical_serialization's items</p></a><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li></ul></div><p class='location'></p><script>window.sidebarCurrent = {name: 'canonical_serialization', ty: 'mod', relpath: '../'};</script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/canonical_serialization/lib.rs.html#1-330' title='goto source code'>[src]</a></span><span class='in-band'>Crate <a class="mod" href=''>canonical_serialization</a></span></h1><div class='docblock'><p>This module defines traits and implementations of canonical serialization mechanism
(A more detailed document describing the motivation and thought process of this work is
in https://fb.quip.com/z6oBAF7x2F2z)</p>
<p>A struct can implement the CanonicalSerialize trait to specify how to serialize itself,
and the CanonicalDeserialize trait to specify deserialization, if it needs to. One design
goal of this serialization format is to optimize for simplicity. It is not designed to be
another full-fledged network serialization as Protobuf or Thrift. It is designed
for doing only one thing right, which is to deterministically generate consistent bytes
from a data structure.</p>
<p>A good example of how to use this framework is described in
./canonical_serialization_test.rs</p>
<p>An extremely simple implementation of CanonicalSerializer is also provided, the encoding
rules are:
(All unsigned integers are encoded in little endian representation unless specified otherwise)</p>
<ol>
<li>
<p>The encoding of an unsigned 64-bit integer is defined as its little endian representation
in 8 bytes</p>
</li>
<li>
<p>The encoding of an item (byte array) is defined as:
[length in bytes, represented as 4-byte integer] || [item in bytes]</p>
</li>
</ol>
<ol start="3">
<li>
<p>The encoding of a list of items is defined as: (This is not implemented yet because
there is no known struct that needs it yet, but can be added later easily)
[No. of items in the list, represented as 4-byte integer] || encoding(item_0) || ....</p>
</li>
<li>
<p>The encoding of an ordered map where the keys are ordered by lexicographic order.
Currently we only support key and value of type Vec<u8>. The encoding is defined as:
[No. of key value pairs in the map, represented as 4-byte integer] || encode(key1) ||
encode(value1) || encode(key2) || encode(value2)...
where the pairs are appended following the lexicographic order of the key</p>
</li>
</ol>
<p>What is canonical serialization?</p>
<p>Canonical serialization guarantees byte consistency when serializing an in-memory
data structure. It is useful for situations where two parties want to efficiently compare
data structures they independently maintain. It happens in consensus where
independent validators need to agree on the state they independently compute. A cryptographic
hash of the serialized data structure is what ultimately gets compared. In order for
this to work, the serialization of the same data structures must be identical when computed
by independent validators potentially running different implementations
of the same spec in different languages.</p>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table><tr class='module-item'><td><a class="struct" href="struct.SimpleDeserializer.html" title='canonical_serialization::SimpleDeserializer struct'>SimpleDeserializer</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="struct" href="struct.SimpleSerializer.html" title='canonical_serialization::SimpleSerializer struct'>SimpleSerializer</a></td><td class='docblock-short'><p>An implementation of a simple canonical serialization format that implements the
CanonicalSerializer trait using a byte vector.</p>
</td></tr></table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table><tr class='module-item'><td><a class="trait" href="trait.CanonicalDeserialize.html" title='canonical_serialization::CanonicalDeserialize trait'>CanonicalDeserialize</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="trait" href="trait.CanonicalDeserializer.html" title='canonical_serialization::CanonicalDeserializer trait'>CanonicalDeserializer</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="trait" href="trait.CanonicalSerialize.html" title='canonical_serialization::CanonicalSerialize trait'>CanonicalSerialize</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="trait" href="trait.CanonicalSerializer.html" title='canonical_serialization::CanonicalSerializer trait'>CanonicalSerializer</a></td><td class='docblock-short'></td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../";window.currentCrate = "canonical_serialization";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>