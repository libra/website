---
id: ir-to-bytecode
title: Move IR Compiler
---

## Summary

The Move IR compiler is the tool that compiles the Move IR down to its
bytecode representation.

## Overview

The Move IR compiler compiles modules and scripts written in Move, down to
their respective bytecode representations. The two data types used to
represent these outputs are `CompiledModule` and `CompiledScript`. These
data types are defined in [file_format.rs](../vm/src/file_format.rs).

The compiler's job is to output bytecode that corresponds as closely as
possible to the input IR. Optimization and advanced semantic checks are not
part of the scope of this tool. On the other hand, the compiler
command-line automatically calls the [bytecode
verifier](../bytecode_verifier) to perform semantic checks on the generated
bytecode.

## Command-line options

```text
USAGE:
    ir_to_bytecode [FLAGS] [OPTIONS] <source_path>

FLAGS:
    -h, --help         Prints help information
        --no-stdlib    Do not automatically compile stdlib dependencies
        --no-verify    Do not automatically run the bytecode verifier
    -s, --script       Treat input file as a script (default is to treat file as a module)
    -V, --version      Prints version information

OPTIONS:
    -o, --output <output_path>    Serialize and write the compiled output to this file

ARGS:
    <source_path>    Path to the Move IR source to compile
```

### Example Usage

To compile a `*.mvir` file

> cargo build --bin ir_to_bytecode

* This will build the compiler+verifier binary
* The binary can be found at `libra/target/debug/ir_to_bytecode`
* Alternatively the binary can be run directly with `cargo run -p ir_to_bytecode`

To compile and verify a `*.mvir` module file
> `ir_to_bytecode a.mvir`

To compile and verify a `*.mvir` transaction script file
> `ir_to_bytecode -s *.mvir`

## Folder Structure

```text
 *
 |- parser/
    |- ast.rs         # Contains all the data structures used to build the AST representing the parsed Move IR input.
    |- syntax.lalrpop # Description of the Move IR language, used by lalrpop to generate a parser.
    |- syntax.rs      # Parser generated by lalrpop using the description in `syntax.lalrpop` - a clean checkout won't contain this file.
 |- compiler.rs       # Main compiler logic - converts an AST generated by `syntax.rs` to a `CompiledModule` or `CompiledScript`.
 |- main.rs           # Compiler driver - parses command-line options and calls the parser, compiler, and bytecode verifier.
 |- util.rs           # Misc compiler utilities.
```
